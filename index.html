<!DOCTYPE html>
<html>
<head>
  <title>Onchain Message</title>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
</head>
<body>
  <h1>Send Onchain Message</h1>
  <textarea id="message" placeholder="Type your message"></textarea><br><br>
  <button id="sendBtn">Send Message</button>

  <script>
    let web3;
    let contract;
    let userAccount;

    const contractAddress = 'YOUR_CONTRACT_ADDRESS';
    const abi = [ /* YOUR_ABI_HERE */ ];

    window.addEventListener('load', async () => {
      if (window.ethereum) {
        web3 = new Web3(window.ethereum);
        try {
          await window.ethereum.request({ method: 'eth_requestAccounts' });
          const accounts = await web3.eth.getAccounts();
          userAccount = accounts[0];

          contract = new web3.eth.Contract(abi, contractAddress);

          document.getElementById("sendBtn").addEventListener("click", async () => {
            const message = document.getElementById("message").value;
            if (!message) return alert("Please type a message.");
            try {
              await contract.methods.sendMessage(message).send({ from: userAccount });
              alert("Message sent!");
            } catch (err) {
              console.error(err);
              alert("Transaction failed.");
            }
          });

        } catch (error) {
          console.error("User denied account access", error);
        }
      } else {
        alert("Please install MetaMask!");
      }
    });
  </script>
</body>
</html>
